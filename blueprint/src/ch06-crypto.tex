\chapter{Cryptographic Foundations}

\section{Security Assumptions}

\begin{itemize}
  \item \textbf{Collision-resistant hash}: SHA3-512 provides 128-bit security against quantum adversaries
  \item \textbf{Unforgeable signatures}: Dilithium2 provides 128-bit security against quantum adversaries
  \item \textbf{ZKP soundness}: Standard zero-knowledge properties (completeness, soundness, zero-knowledge)
  \item \textbf{Independent nonce generation}: Cryptographically random nonces with sufficient entropy
\end{itemize}

\section{Threat Model and Mitigations}

\subsection{Impersonation Attack (Different Secret Key)}

\begin{itemize}
  \item \textbf{Attack}: Attacker uses different secret key to forge ZKP
  \item \textbf{Defense}: DIDComm makes sender's public key known to recipient
  \item \textbf{Result}: Different secret key $\Rightarrow$ signature verification fails
  \item \textbf{Protocol layer}: Cryptographically prevented
\end{itemize}

\subsection{Replay Attack (Same ZKP, Same User)}

\begin{itemize}
  \item \textbf{Attack}: Legitimate user reuses identical ZKP in new session
  \item \textbf{Defense}: Dual nonce binding ensures each ZKP corresponds to unique nonce pair
  \item \textbf{Result}: Session-specific ZKP cannot be reused
  \item \textbf{Service layer}: Optional nonce history management (service responsibility)
\end{itemize}

\subsection{Man-in-the-Middle Attack}

\begin{itemize}
  \item \textbf{Attack}: Intermediary intercepts and modifies messages
  \item \textbf{Defense}: ECDH-1PU authenticated encryption (service provider responsibility)
  \item \textbf{Result}: Message authentication prevents undetected modification
  \item \textbf{Transport layer}: TLS/HTTPS (service provider responsibility)
\end{itemize}

\subsection{Sybil Attack (Multiple DIDs)}

\begin{itemize}
  \item \textbf{Attack}: Single entity controls multiple DIDs to gain asymmetric advantages
  \item \textbf{Protocol position}: Multiple DID possession is intentional design for privacy
  \item \textbf{Mitigation}: Anonymous Hash Identifier (AHI) restricts per-audit-domain abuse
  \item \textbf{Social layer}: Operational policy and service-specific restrictions
\end{itemize}

